<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Agenda</title>

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body { font-family: Arial; padding: 20px; }
    #calendar { max-width: 900px; margin: auto; }
  </style>
</head>
<body>

<h2>Selecciona un horario disponible</h2>
<div id="calendar"></div>

<script>
  // ðŸ”‘ Supabase config
  const SUPABASE_URL = "TU_URL";
  const SUPABASE_KEY = "TU_ANON_KEY";
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  document.addEventListener('DOMContentLoaded', async function () {

    // ðŸ“¥ Cargar disponibilidad desde Supabase
    const { data, error } = await supabase
      .from('disponibilidad')
      .select('*')
      .eq('disponible', true);

    if (error) {
      console.error(error);
      return;
    }

    // Convertir a eventos
    const events = data.map(d => ({
      title: 'Disponible',
      start: `${d.fecha}T${d.hora_inicio}`,
      end: `${d.fecha}T${d.hora_fin}`,
      color: 'green'
    }));

    // ðŸ“… Inicializar calendario
    const calendar = new FullCalendar.Calendar(
      document.getElementById('calendar'),
      {
        initialView: 'timeGridWeek',
        selectable: true,
        events: events,

        eventClick: function(info) {
          alert(
            `Reservaste:\n${info.event.start.toLocaleString()}`
          );
        }
      }
    );

    calendar.render();
  });
</script>

</body>
</html>